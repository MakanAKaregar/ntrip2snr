## ntrip2snr
Using [BKG Ntrip Client (BNC)](https://igs.bkg.bund.de/ntrip/bnc) and [gnssrefl](https://github.com/kristinemlarson/gnssrefl)'s rt_rinex3_snr module to access real-time SNR data.

The BNC compiled code is available at: https://igs.bkg.bund.de/ntrip/bnc

I tested Code Executable "v2.12.18 static" for OpenSUSE, Ubuntu, Debian and Raspbian. The compiled file <code>bnc-2.12.18-suse42-64bit-static</code> and 
<code>bnc-2.12.18-debian8-64bit-static</code> are also available in ntrip2snr repository. 

The following examples convert 1 min RTCM streams to RINEX 3 files and then to SNR-ready files to be used for real-time processing.

## Example 1: GNSS SNR real-time streaming for site AC67 from UNAVCO's caster: rtgpsout.unavco.org:2101

#Note: you need to reach out [UNAVCO](https://www.unavco.org/data/gps-gnss/real-time/real-time.html) to set up an account with user and pass. 

Navigate to example1 directory and open <code>ntrip2snr.bnc</code> in a text editor and set the following configuration input parameters:

<code>casterUrlList=</code>Visited Broadcasters [character string, comma separated list], example:  <code>http://user:pass@rtgpsout.unavco.org:2101</code>

<code>mountPoints=</code>Mountpoints [character string, semicolon separated list, example: <code>//user:pass@rtgpsout.unavco.org:2101/AC67_RTCM3 RTCM_3.1 USA 57.79 -152.43 no 2</code>

<code>rnxScript=</code>File upload script, full path [character string], example: <code>./run_rinex2snr.sh</code>. <code>run_rinex2snr.sh</code> passes the RINEX 3 filename generated by BNC to [gnssrefl](https://github.com/kristinemlarson/gnssrefl)'s [rinex2snr](https://github.com/kristinemlarson/gnssrefl/blob/master/docs/pages/rinex2snr.md) module. 

<code>rnxIntr=</code>File interval [character string: 1 min|2 min|5 min|10 min|15 min|30 min|1 hour|1 day], example: <code>1 min</code>

<code>rnxV3=</code>Produce version 3 file content [integer number: 0=no,2=yes], example: <code>2</code>

<code>rnxSampl=</code>File sampling rate [integer number of seconds: 0,5|10|15|20|25|30|35|40|45|50|55|60], example: <code>1 sec</code> 

<code>rnxSkel=</code>RINEX skeleton file extension [character string], example: <code>SKL</code>

Default configuration is set for an orbitray site [AC67](https://www.unavco.org/instrumentation/networks/status/nota/overview/AC67) from UNAVCO's caster server (rtgpsout.unavco.org:2101)

Set a directory to store RINEX 3 files via <code> -key rnxPath $REFL_CODE/rinex/ssss/YYYY</code> where [$REFL_CODE](https://github.com/kristinemlarson/gnssrefl/blob/master/docs/pages/README_install.md) is an environmental variable to be used by gnssrefl's [rt_rinex3_snr](https://github.com/kristinemlarson/gnssrefl/blob/master/gnssrefl/rt_rinex3_snr.py) module, YYYY is the year and ssss is the four character station name., example: <code>-key rnxPath $REFL_CODE/rinex/AC67/2023</code>

Before running <code>ntrip2snr.bnc</code>, BNC requires the RINEX header as a separate file with SKL extension stored in <code>$REFL_CODE/rinex/ssss/YYYY</code> (rnxPath). For running the example configuration file, make sure you copy <code>AC67_RTCM.SKL</code> to the mentioned directory. The RINEX header file is often missed in caster servers, thus this <code>.SKL</code> file needs to be created in advance. 

Now activate the virtual environment: <code>source ~/env/bin/activate</code>

To run <code>ntrip2snr: ./bnc-2.12.18-suse42(debian8)-64bit-static -nw -conf ntrip2snr.bnc -key rnxPath $REFL_CODE/rinex/AC67/2023</code>

Ignore QSslSocket SSL errors if you generally trust the caster server and do not want to be bothered with this.

SNR-ready files are overwritten every minute and stored in <code>$REFL_CODE/YYYY/snr/ssss/</code>, example: <code>$REFL_CODE/2023/snr/AC67/</code>

## Example 2: GNSS SNR real-time streaming for site WARN from EUREF's caster: euref-ip.net:2101

#Note: access to EUREF's caster is public and no user and pass are required.

The configuration input parameters for this example are available in ~/example2/<code>ntrip2snr.bnc</code>

Default configuration is set for a GNSS-IR site [WARN](https://epncb.oma.be/_networkdata/siteinfo4onestation.php?station=WARN00DEU) from EUREF's caster caster server (euref-ip.net:2101)

And run <code>ntrip2snr: ./bnc-2.12.18-suse42(debian8)-64bit-static -nw -conf ntrip2snr.bnc -key rnxPath $REFL_CODE/rinex/WARN/2023</code>

SNR-ready files are overwritten every minute and stored in <code>$REFL_CODE/YYYY/snr/ssss/</code>, example: <code>$REFL_CODE/2023/snr/WARN/</code>

